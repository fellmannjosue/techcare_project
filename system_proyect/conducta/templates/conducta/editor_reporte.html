{% extends "base.html" %}
{% load static %}
{% block content %}
<link href="{% static 'css/editor_reporte.css' %}" rel="stylesheet">

<div class="container mt-4 editor-reporte-box">
    <h2>
        {% if tipo_reporte == "conductual" %}
            Editar Reporte Conductual
        {% elif tipo_reporte == "informativo" %}
            Editar Reporte Informativo
        {% else %}
            Editar Progress Report
        {% endif %}
    </h2>
    <form method="post" id="form-editor-reporte">
        {% csrf_token %}

        <div class="mb-3">
            {{ form.fecha.label_tag }} {{ form.fecha }}
        </div>
        <div class="mb-3">
            {{ form.alumno.label_tag }} {{ form.alumno }}
        </div>
        <div class="mb-3">
            {{ form.grado.label_tag }} {{ form.grado }}
        </div>
        <div class="mb-3">
            {{ form.materia_docente.label_tag }} {{ form.materia_docente }}
        </div>
        
        {# Incisos solo para conductual #}
        {% if tipo_reporte == "conductual" %}
            <div class="mb-3">
                <label><b>Incisos (por severidad):</b></label>
                <div class="row">
                    <div class="col-md-4">
                        {{ form.leve }} {{ form.inciso_leve.label_tag }} {{ form.inciso_leve }}
                    </div>
                    <div class="col-md-4">
                        {{ form.grave }} {{ form.inciso_grave.label_tag }} {{ form.inciso_grave }}
                    </div>
                    <div class="col-md-4">
                        {{ form.muy_grave }} {{ form.inciso_muy_grave.label_tag }} {{ form.inciso_muy_grave }}
                    </div>
                </div>
            </div>
        {% endif %}

        {# Materias para progress #}
        {% if tipo_reporte == "progress" %}
            <div class="mb-3">
                {{ form.semana_inicio.label_tag }} {{ form.semana_inicio }}
                {{ form.semana_fin.label_tag }} {{ form.semana_fin }}
            </div>
            <div class="mb-3">
                {{ form.comentario_general.label_tag }} {{ form.comentario_general }}
            </div>
        {% endif %}

        {# Comentario para informativo y conductual #}
        {% if tipo_reporte == "informativo" %}
            <div class="mb-3">
                {{ form.comentario.label_tag }} {{ form.comentario }}
            </div>
        {% elif tipo_reporte == "conductual" %}
            <div class="mb-3">
                {{ form.comentario.label_tag }} {{ form.comentario }}
            </div>
        {% endif %}

        {# Campos especiales solo para coordinador #}
        {% if es_coordinador %}
            <div class="mb-3">
                {{ form.coordinador_firma.label_tag }} {{ form.coordinador_firma }}
            </div>
            <div class="mb-3">
                {{ form.estado.label_tag }} {{ form.estado }}
            </div>
        {% endif %}

        <button type="submit" class="btn btn-success">Guardar Cambios</button>
        <a href="javascript:history.back();" class="btn btn-secondary">Cancelar</a>
    </form>
</div>

<script src="{% static 'js/editor_reporte.js' %}"></script>
{% endblock %}
